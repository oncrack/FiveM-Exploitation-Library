
import requests

from colorama import Fore, Back

class dumping:

    def dump_players(cfx):
        r = requests.get(f'http://{cfx}')
        header = r.headers['x-citizenfx-url']
        ip = header.strip('http://')

        url = requests.get(f'http://{ip}/players.json')
        data = url.json()
        lenplayer = len(data)

        print('\nID, Name:\n')
    
        for i in range(lenplayer):
            print(f"{Fore.RED}•{Fore.RESET} {data[i]['id']}, {data[i]['name']}")

    def dump_info(cfx):
        r = requests.get(f'http://{cfx}')
        header = r.headers['x-citizenfx-url']
        ip = header.strip('http://')

        url = requests.get(f'http://{ip}/dynamic.json')
        url2 = requests.get(f'http://{ip}/info.json')

        data = url.json()
        data2 = url2.json()['vars']
    
        print(f"""
{Fore.RED}•{Fore.RESET} Name          : {data['hostname']}
{Fore.RED}•{Fore.RESET} Clients       : {data['clients']}/{data['sv_maxclients']}
{Fore.RED}•{Fore.RESET} Gametype      : {data['gametype']}
{Fore.RED}•{Fore.RESET} Tags          : {data2['tags']}
        """)

    def dump_resources(cfx):
        r = requests.get(f'http://{cfx}')
        header = r.headers['x-citizenfx-url']
        ip = header.strip('http://')

        url = requests.get(f'http://{ip}/info.json')
        data = url.json()

        print(f"\n {data['resources']}")

        with open('resources.txt', 'a') as f:
            f.write(str(data['resources']))

    def parse_cfx(cfx):
        r = requests.get(f'http://{cfx}')
        header = r.headers['x-citizenfx-url']
        ip = header.strip('http://')

        print(f'\n{Fore.RED}•{Fore.RESET} IP: {ip}')

    def scanner(cfx):
        r = requests.get(f'http://{cfx}')
        header = r.headers['x-citizenfx-url']
        ip = header.strip('http://')

        url = requests.get(f'http://{ip}/info.json')
        data = url.json()
        t = []

        exploits = ['vrp_trucker', 'runcode', 'vrp_mysql', 'vrp_taxi']

        for i in exploits:
            if i in url.text:
                print(f'{Fore.RED}•{Fore.RESET} {i}')
                t.append(i)

        print(f'\nRaw: {t}')